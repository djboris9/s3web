<!DOCTYPE html>
<!--
Copyright (C) 2013 djboris.

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
MA 02110-1301  USA
-->
<div ng-controller="BrowseCtrl">
    <h2>Browser</h2>
    <table>
        <tr>
            <td>Bucket</td>
            <td><input type="text" ng-model="bucket" /><button ng-click='refresh()'>Get</button></td>
        </tr>
        <tr ng-show="loaded">
            <td>Location</td>
            <td><input type="text" ng-model="actual_dir" size="100" readonly="readonly" /></td>
        </tr>
        <tr ng-show="loaded">
            <td>Search</td>
            <td><input type="text" ng-model="searchtext" /></td>
        </tr>
    </table>

    <h3>Files</h3>
    <div ng-if="(!(actual_dir|endswith:'/')) && (actual_dir != '')">
        <a class="btn btn-success" href="{{ getObjectLink(bucket, actual_dir)}}" target="_blank">Download</a>
    </div>

    <div id="filecontainer list-group" ng-if="(actual_dir|endswith:'/') || (actual_dir == '')">
        <div class="file list-group-item " ng-repeat="file in files|indir:actual_dir|filter:searchtext" ng-controller="FileCtrl">

            <div class="file_key list-group-item-heading">
                <a ng-if="!(file.Key |endswith:'/')" 
                   href="{{ getObjectLink(bucket, actual_dir)}}" 
                   target="_blank">
                    {{ file.Key |basename }}
                </a>
                <a ng-if="(file.Key |endswith:'/')" 
                   ng-click="open(file)">
                    {{ file.Key |basename }}
                </a>
                <a ng-hide="detail" ng-click="detail = true" ng-init="detail = false">
                    Details
                </a>
                <a ng-show="detail" ng-click="detail = false">
                    Hide
                </a>
            </div>

            <div class="list-group-item-text" ng-show="detail">
                <table>
                    <tr>
                        <td>LastModified</td>
                        <td>{{ file.LastModified}}</td>
                    </tr>
                    <tr>
                        <td>Size</td>
                        <td>{{Â file.Size}}</td>
                    </tr>
                    <tr>
                        <td>StorageClass</td>
                        <td>{{ file.StorageClass}}</td>
                    </tr>
                </table>
            </div>

        </div>
    </div>
</div>